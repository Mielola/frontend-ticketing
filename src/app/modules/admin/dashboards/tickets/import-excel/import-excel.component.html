<div class="h-full w-full flex flex-col">
    <div class="flex justify-between p-2">
        <div
            class="truncate text-lg font-medium leading-6 tracking-tight px-5 py-3 flex flex-col items-start w-full justify-between">
            <h2 class="mb-2 text-2xl font-semibold sm:mb-0">Import Excel</h2>
            <p class="text-sm text-gray-500">
                Upload an Excel file.
                <a href="files/template_ticket_import.xlsx" download class="text-blue-600 underline">Download here</a>.
            </p>
        </div>
        <a (click)="dialogRef.close()">
            <mat-icon svgIcon="mat_solid:close" class="cursor-pointer"></mat-icon>
        </a>
    </div>

    <ion-loading [isOpen]="isLoading" message="Sumbitting Form..." spinner="circular"></ion-loading>

    <div class="">
        <form class="bg-card flex flex-col overflow-hidden rounded-2xl px-8 py-4 pb-4 gap-5">

            <!-- Excel File Input -->
            <div class="flex flex-col gap-2">
                <label for="excelFile" class="text-sm font-medium text-gray-700 mb-1">Upload Excel File</label>

                <!-- Custom Input Style -->
                <div
                    class="flex items-center border border-gray-300 rounded-lg px-4 py-2 cursor-pointer hover:border-blue-500">
                    <!-- Hidden File Input -->
                    <input type="file" id="excelFile" (change)="onFileChange($event)" accept=".xlsx, .xls"
                        class="hidden" />

                    <!-- Clickable Label -->
                    <label for="excelFile" class="flex-1 text-gray-600 cursor-pointer">
                        {{ selectedFile ? selectedFile.name : 'Choose Excel file...' }}
                    </label>

                    <!-- Upload Icon -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-gray-500" fill="none"
                        viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0l3-3m-3 3l-3-3M16 8V4H8v4" />
                    </svg>
                </div>
            </div>



            <button class="bg-green-600 text-white p-2 rounded" type="submit" (click)="onSubmit()">
                Import Excel
            </button>
        </form>
    </div>
</div>